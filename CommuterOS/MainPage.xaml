<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CommuterOS.MainPage"
             BackgroundColor="#0D0D0D"
             Shell.NavBarIsVisible="False">

<Grid>
        <ScrollView>
            <VerticalStackLayout Spacing="25" Padding="25" Margin="0,20,0,0" VerticalOptions="Start">

                <Border Stroke="#FFB000" StrokeThickness="2" BackgroundColor="Transparent" Padding="10">
                    <VerticalStackLayout>
                        <FlexLayout JustifyContent="SpaceBetween">
                            <Label Text="[SYS.RDY] COMMUTER-OS" FontFamily="RetroFont" TextColor="#FFB000" FontSize="20"/>
                            <Label Text="[*]" FontFamily="RetroFont" TextColor="#FFB000" FontSize="20"/>
                        </FlexLayout>
                        <BoxView HeightRequest="2" Color="#FFB000" Margin="0,5,0,5"/>
                        <Label Text="{Binding CurrentTimeString}" FontFamily="RetroFont" TextColor="#FFB000" FontSize="28"/>
                    </VerticalStackLayout>
                </Border>

                <Border Stroke="#FFB000" StrokeThickness="4" BackgroundColor="#1A1A00" Padding="20">
                    <Border.StrokeShape><RoundRectangle CornerRadius="4"/></Border.StrokeShape>
                    <VerticalStackLayout Spacing="10">
                        <Label Text="{Binding ModeText}" FontFamily="RetroFont" TextColor="#FFB000" FontSize="26" HorizontalOptions="Center"/>
                        
                        <Label Text="{Binding TimeToLeaveString}" 
                               FontFamily="RetroFont" 
                               TextColor="{Binding TimerColor}"
                               FontSize="44" 
                               HorizontalOptions="Center"
                               FontAttributes="Bold">
                            <Label.Shadow>
                                <Shadow Brush="#FFB000" Offset="0,0" Radius="15" Opacity="0.8"/>
                            </Label.Shadow>
                        </Label>

                        <Label Text="{Binding SuggestionText}" FontFamily="RetroFont" TextColor="#FFB000" FontSize="22" HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>

                <Border Stroke="#FFB000" StrokeThickness="1" BackgroundColor="#1A1A00" Padding="15">
                    <VerticalStackLayout Spacing="5" HeightRequest="150" BindableLayout.ItemsSource="{Binding RouteSteps}">
                        <Label Text="ROUTE :" FontFamily="RetroFont" TextColor="#FFB000" FontAttributes="Bold" FontSize="22"/>
                        <BindableLayout.ItemTemplate>
                            <DataTemplate>
                                <Label Text="{Binding .}" 
                                    FontFamily="RetroFont" 
                                    TextColor="#FFB000" 
                                    FontSize="18"
                                    LineBreakMode="WordWrap"/> 
                            </DataTemplate>
                        </BindableLayout.ItemTemplate>
                        <BindableLayout.EmptyView>
                            <Label Text="[NO DATA]" FontFamily="RetroFont" TextColor="#FFB000" Opacity="0.5" />
                        </BindableLayout.EmptyView>
                    </VerticalStackLayout>
                </Border>

                <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,*" RowSpacing="15" ColumnSpacing="15">
                    
                    <Button Grid.Row="0" Grid.Column="0" 
                            Text="[SWITCH]" 
                            FontFamily="RetroFont" TextColor="#FFB000" 
                            BackgroundColor="#111" BorderColor="#FFB000" BorderWidth="2" HeightRequest="70" FontSize="22"
                            Clicked="OnSwitchModeClicked"/>

                    <Button Grid.Row="0" Grid.Column="1" 
                            Text="{Binding PriorityButtonText}" 
                            FontFamily="RetroFont" TextColor="#FFB000" 
                            BackgroundColor="#111" BorderColor="#FFB000" BorderWidth="2" HeightRequest="70" FontSize="22"
                            Clicked="OnPriorityClicked"/>
                    
                    <Button Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                            Text="[ REFRESH ROUTE ]" 
                            FontFamily="RetroFont" TextColor="#0D0D0D" 
                            BackgroundColor="#FFB000" BorderColor="#FFB000" BorderWidth="2" HeightRequest="80" FontSize="26" FontAttributes="Bold"
                            Clicked="OnRefreshClicked"/>
                </Grid>

            </VerticalStackLayout>
        </ScrollView>

        <GraphicsView Drawable="{StaticResource ScanlineDrawable}" InputTransparent="True" Opacity="0.7"/>
    </Grid>
</ContentPage>
